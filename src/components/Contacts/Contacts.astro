---
import PhoneInput from '../PhoneInput/PhoneInput.astro';
import './contacts.css';
---

<section id="contacts" class="contacts-section">
  <div class="contacts-bg"></div>
  <div class="contacts-overlay"></div>

  <div class="contacts-inner" data-aos="fade-up">
    <h2 class="contacts-title">Оставьте заявку</h2>

    <p class="contacts-subtitle">
      Расскажите, какой автомобиль вы ищете — мы подберём лучшие варианты и рассчитаем стоимость с
      доставкой и оформлением.
    </p>

    <form class="contacts-form" id="contacts-form">
      <div class="input-wrapper">
        <input type="text" name="name" class="contacts-input" placeholder="Имя" />
      </div>

      <div class="input-wrapper">
        <PhoneInput id="contacts-phone" name="phone" />
      </div>

      <button type="submit" class="contacts-button"> Оставить заявку </button>
    </form>

    <p class="contacts-consent">
      Отправляя заявку, вы даете свое согласие на <a href="/policy">обработку персональных данных</a
      >.
    </p>
  </div>
</section>

<script>
  import { initFormValidation } from '../../scripts/formValidation';

  // Wait for phone input to be initialized
  window.addEventListener('load', () => {
    const form = document.getElementById('contacts-form') as HTMLFormElement;

    if (form) {
      // Small delay to ensure intl-tel-input is initialized
      setTimeout(() => {
        initFormValidation(form, (formData) => {
          console.log('Contacts form submitted:', formData);
          // Here you can add your form submission logic (e.g., send to API)
          alert('Заявка отправлена!');
          form.reset();
        });
      }, 100);
    }
  });
</script>
