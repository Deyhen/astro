---
import './stats.css';
---

<section id="stats" class="stats-section">
  <div class="stats-container">
    <div data-aos="fade-up" class="wrap">
      <span class="count">
        <h5 class="stat-number" data-target="12">0</h5>+
      </span>
      <div class="line"></div>
      <p class="label">Лет на рынке</p>
    </div>

    <div data-aos="fade-up" data-aos-delay="100" class="wrap">
      <span class="count">
        <h5 class="stat-number" data-target="1500">0</h5>+
      </span>
      <div class="line"></div>
      <p class="label">Довольных клиентов</p>
    </div>

    <div data-aos="fade-up" data-aos-delay="150" class="wrap">
      <span class="count">
        <h5 class="stat-number" data-target="30">0</h5>+
      </span>
      <div class="line"></div>
      <p class="label">Стран поставки</p>
    </div>

    <div data-aos="fade-up" data-aos-delay="200" class="wrap">
      <h5 class="count">24/7</h5>
      <div class="line"></div>
      <p class="label">Поддержка клиентов</p>
    </div>
  </div>
</section>

<script is:inline>
  function animateCount(el) {
    const target = +el.dataset.target;
    let current = 0;
    const duration = 1200;
    const steps = 60;
    const step = target / steps;
    let frame = 0;

    const interval = setInterval(() => {
      frame++;
      current += step;

      if (frame >= steps) {
        el.textContent = target;
        clearInterval(interval);
      } else {
        el.textContent = Math.floor(current);
      }
    }, duration / steps);
  }

  const observer = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          animateCount(entry.target);
          observer.unobserve(entry.target);
        }
      });
    },
    { threshold: 0.3 },
  );

  document.querySelectorAll('.stat-number').forEach((el) => observer.observe(el));
</script>
